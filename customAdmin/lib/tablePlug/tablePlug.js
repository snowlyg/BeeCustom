var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};layui.define(["table"],function(e){"use strict";var t="2.5.5-preview01",a="tablePlug",i=layui.cache.modules[a]||"",l=i.substr(0,i.lastIndexOf("/"));layui.link(l+"/tablePlug.css?v"+t),layui.link(l+"/icon/iconfont.css?v"+t);var b=layui.$,x=layui.laytpl,s=layui.laypage,u=layui.layer,d=layui.form,k=(layui.util,layui.table),n=layui.hint();layui.device();if(!d.render.plugFlag){var c=d.render;d.render=function(n,e,t){var o,r=this;return t?layui.each(t,function(e,t){var a=(t=b(t)).parent(),i=a.hasClass("layui-form"),l=a.attr("lay-filter");i||a.addClass("layui-form"),l||a.attr("lay-filter","tablePlug_form_filter_temp_"+(new Date).getTime()+"_"+Math.floor(1e5*Math.random())),o=c.call(r,n,a.attr("lay-filter")),i||a.removeClass("layui-form"),l||a.attr("lay-filter",null)}):o=c.call(r,n,e),o},d.render.plugFlag=!0}layui.extend({optimizeSelectOption:"{/}"+l+"/optimizeSelectOption/optimizeSelectOption"}).use("optimizeSelectOption");layui.device().ie&&parseInt(layui.device().ie)<9&&console.warn("tablePlug插件暂时不支持ie9以下的ie浏览器，如果需要支持可自行调试，一般就是一些数组的方法ie8没有还有一个重要的就是window.parent这些支持不好，在getPosition的时候会死循环，如果有这方面相关的经验有处理方法请分享给俺，谢谢。"),k.thisTable&&k.Class||console.error("如果要使用该插件（tablePlug），参照readme.md的说明修改layui的table模块的代码，目前该组件是基于layui-V2.5.5","https://gitee.com/sun_zoro/layuiTablePlug");function T(e,t,a,i){var l=e.templet?"function"==typeof e.templet?e.templet(a):x(b(e.templet).html()||String(t)).render(a):t;return i?b("<div>"+l+"</div>").text():l}function f(e){return k.thisTable.that[e]}function y(e,t,a){if(e&&t&&(a=a||Z(t))&&a.checkStatus)for(var i=F.getChecked(t),l=0;l<e.length;l++)e[l][k.config.checkName]=-1!==i.indexOf(e[l][ae(a)])}function o(a,e){var i;if("string"==typeof a?i=Z(a):(i=a.config,a=i?i.id:""),i){var l=i.elem.next();e&&(i.checkDisabled=i.checkDisabled||{},i.checkDisabled.enabled=i.checkDisabled.enabled||!0,i.checkDisabled.data=F.get(a,_)||[]),i.checkDisabled&&i.checkDisabled.enabled?layui.each(k.cache[a],function(e,t){l.find(".layui-table-body").find('tr[data-index="'+e+'"]').find('input[name="layTableCheckbox"],[lay-type="layTableRadio"]').prop("disabled",F.checkDisabled(a,t[ae(i)]))}):F.set(a,_,[]),l.find('input[lay-filter="layTableAllChoose"]').prop("checked",k.checkStatus(a).isAll),d.render("checkbox",l.attr("lay-filter")),d.render("radio",l.attr("lay-filter"))}}var h,r,p={version:t},g={},m="additional",v="removed",C="original",_="disabled",L="layui-table-fixed-scroll",O="layui-table-view",w=".layui-table-header",A=".layui-table-body",S=".layui-table-fixed",D=".layui-table-fixed-l",P=".layui-table-fixed-r",N="layui-none",B="layui-hide",j="colGroup",E=["numbers","checkbox","radio"],I=['<span class="layui-table-filter layui-inline">','<span class="layui-tablePlug-icon layui-tablePlug-icon-filter"></span>',"</span>"],F=(r={},{check:function(e){return!!r[e]},reset:function(e){r[e]?(this.set(e,m,[]),this.set(e,v,[])):(r[e]={},r[e][C]=[],r[e][m]=[],r[e][v]=[],r[e][_]=[])},init:function(e,t,a){this.reset(e);var i=[];i=t&&t.length&&"object"===_typeof(t[0])?K(e,t,a):t,this.set(e,C,i)},disabled:function(e,t){r[e]||this.reset(e),this.set(e,_,t)},checkDisabled:function(e,t){return-1!==this.get(e,_).indexOf(t)},getChecked:function(e){var a=this.get(e,v),t=this.get(e,C).concat(this.get(e,m)),i=[];return layui.each(t,function(e,t){-1===a.indexOf(t)&&-1===i.indexOf(t)&&i.push(t)}),i},get:function(e,t){return t===m||t===v||t===C||t===_?r[e]&&r[e][t]||[]:r[e]},set:function(e,t,a){t!==C&&t!==m&&t!==v&&t!==_||(r[e][t]=a&&R(a)?a:[])},update:function(e,t,a,i){var l=r[e][C],n=r[e][m],o=r[e][v];a?(i&&n.splice(0,1),-1===l.indexOf(t)?-1===n.indexOf(t)&&n.push(t):i||-1===o.indexOf(t)||o.splice(o.indexOf(t),1)):-1===l.indexOf(t)?-1!==n.indexOf(t)&&n.splice(n.indexOf(t),1):-1===o.indexOf(t)&&o.push(t)}}),R=function(e){return"[object Array]"===Object.prototype.toString.call(e)};function M(e,t,a){t=t||window,e=e.length?e.get(0):e;var i={};a&&t.top!==t.self&&(i=M(t.frames.frameElement,t.parent,a));var l=e.getBoundingClientRect();return{top:l.top+(i.top||0),left:l.left+(i.left||0)}}p.set=function(e){b.extend(!0,k.config,e||{})},p.set({pageLanguageText:{en:{jumpTo:"jump to",page:"page",go:"go",total:"total",unit:"",optionText:"limit each page"}}}),k.Class.prototype.initTable=function(){var e=this;e.config;e.layFixed.find("tbody").html(""),e.layFixed.addClass(B),e.layTotal.addClass(B),e.layPage.addClass(B),e.layMain.find("tbody").html(""),e.layMain.find("."+N).remove(),e.layHeader.find('input[name="layTableCheckbox"]').prop("checked",!1),e.renderForm("checkbox")};function H(e){var a=this,t=a.config;e&&(a.layBody.scrollTop(0),a.layBody.scrollLeft(0)),o(a),G.call(a),layui.each(a.tempData,function(e,t){a.addTemp(e+1,t,null,!0)}),!0===t.reversal&&a.reverse(),a.layBody.find('input[type="checkbox"][name="layTableCheckbox"]').attr("lay-filter","layTableCheckbox"),de(a),K(t)}var Y={},K=function(e,t,a){var i="string"==typeof e?Z(e):e;return a=a||ae(i),i.checkStatus&&a&&(Y[i.id]=Y[i.id]||{},layui.each(t||k.cache[i.id]||[],function(e,t){Y[i.id][t[a]]=t})),(t||k.cache[i.id]||[]).map(function(e){return e[a]})};k.Class.prototype.errorView=function(e){var t=this,a=t.layMain.find("."+N),i=b('<div class="'+N+'">'+(e||"Error")+"</div>");a[0]&&(t.layNone.remove(),a.remove()),t.layFixed.addClass(B).find("tbody").html(""),t.layMain.find("tbody").html(""),t.layMain.append(t.layNone=i),t.layPage&&t.layPage.addClass(B).find(">div").html(""),t.layTotal&&t.layTotal.addClass(B).find("tbody").html(""),k.cache[t.key]=[]},k.Class.prototype.pullData=function(t,a){function i(){"object"===_typeof(n.initSort)&&l.sort(n.initSort.field,n.initSort.type)}var l=this,n=l.config,e=n.request,o=n.response;if(l.startTime=(new Date).getTime(),n.url){var r={};r[e.pageName]=t,r[e.limitName]=n.limit;var c=b.extend(r,n.where);"function"==typeof n.renderRequest&&(c=n.renderRequest(c)),n.contentType&&0==n.contentType.indexOf("application/json")&&(c=JSON.stringify(c)),l.loading(),b.ajax({type:n.method||"get",url:n.url,contentType:n.contentType,data:c,dataType:"json",headers:n.headers||{},success:function(e){"function"==typeof n.parseData&&(e=n.parseData(e)||e),e[o.statusName]!=o.statusCode?(l.renderForm(),l.errorView(e[o.msgName]||'返回的数据不符合规范，正确的成功状态码应为："'+o.statusName+'": '+o.statusCode)):(l.renderData(e,t,e[o.countName],!1,a&&(!n.page||n.page.count===e[o.countName])),i(),n.time=(new Date).getTime()-l.startTime+" ms"),a?l.loading(!0):l.setColsWidth(),"function"==typeof n.done&&n.done(e,t,e[o.countName])},error:function(e,t){l.errorView("数据接口请求异常："+t),l.renderForm(),a?l.loading(!0):l.setColsWidth()}})}else if(n.data&&n.data.constructor===Array){var s={},d=t*n.limit-n.limit;s[o.dataName]=n.data.concat().splice(d,n.limit),s[o.countName]=n.data.length,l.renderData(s,t,s[o.countName],!1,a&&(!n.page||n.page.count===n.data.length)),i(),a?l.loading(!0):l.setColsWidth(),"function"==typeof n.done&&n.done(s,t,s[o.countName])}},k.Class.prototype.renderData=function(e,t,a,i,l){function n(){var h;if(!i&&p.sortKey)return p.sort(p.sortKey.field,p.sortKey.sort,!0);layui.each(o,function(c,s){var d=[],u=[],f=[],y=c+g.limit*(t-1)+1;0!==s.length&&(i||(s[k.config.indexName]=c),p.eachCols(function(e,a){var t=a.field||e,i=g.index+"-"+a.key,l=s[t];if(null==l&&(l=""),!a.colGroup){var n,o,r=['<td data-field="'+t+'" data-key="'+i+'" '+(o=[],a.edit&&o.push('data-edit="'+a.edit+'"'),a.align&&o.push('align="'+a.align+'"'),a.templet&&o.push('data-content="'+l+'"'),a.event&&o.push('lay-event="'+a.event+'"'),a.style&&o.push('style="'+a.style+'"'),a.minWidth&&o.push('data-minwidth="'+a.minWidth+'"'),o.join(" "))+' class="'+(n=[],a.hide&&n.push(B),a.field||n.push("layui-table-col-special"),n.join(" "))+'">','<div class="layui-table-cell laytable-cell-'+("normal"===a.type?i:i+" laytable-cell-"+a.type)+'">'+function(){var e=b.extend(!0,{LAY_INDEX:y},s),t=k.config.checkName;switch(a.type){case"checkbox":return'<input type="checkbox" name="layTableCheckbox" lay-skin="primary" '+(a[t]?(s[t]=a[t],a[t]?"checked":""):e[t]?"checked":"")+">";case"radio":return e[t]&&(h=c),'<input type="radio" name="layTableRadio_'+g.index+'" '+(e[t]?"checked":"")+' lay-type="layTableRadio">';case"numbers":return y}return a.toolbar?x(b(a.toolbar).html()||"").render(e):T(a,l,e)}(),"</div></td>"].join("");d.push(r),a.fixed&&"right"!==a.fixed&&u.push(r),"right"===a.fixed&&f.push(r)}}),r.push('<tr data-index="'+c+'">'+d.join("")+"</tr>"),m.push('<tr data-index="'+c+'">'+u.join("")+"</tr>"),v.push('<tr data-index="'+c+'">'+f.join("")+"</tr>"))}),l||p.layBody.scrollTop(0),p.layMain.find("."+N).remove(),p.layMain.find("tbody").html(r.join("")),p.layFixLeft.find("tbody").html(m.join("")),p.layFixRight.find("tbody").html(v.join("")),p.renderForm(),"number"==typeof h&&p.setThisRowChecked(h),p.syncCheckAll(),p.haveInit?p.scrollPatch():setTimeout(function(){p.scrollPatch()},50),p.haveInit=!0,u.close(p.tipsIndex),g.HAS_SET_COLS_PATCH||p.setColsPatch(),g.HAS_SET_COLS_PATCH=!0}var p=this,g=p.config,o=e[g.response.dataName]||[],r=[],m=[],v=[];y(o,g.id,g);var c=k.getTemp(p.key);return p.tempData=c.data,k.cache[p.key]=o,p.layPage[0==a||0===o.length&&1==t?"addClass":"removeClass"](B),0===o.length?(p.renderForm(),p.errorView(g.text.none),H.call(p,!0)):(p.layFixed.removeClass(B),i?(n(),H.call(p)):(n(),l?H.call(p):(p.renderTotal(o),p.layTotal&&p.layTotal.removeClass(B),g.page&&(g.page=b.extend({elem:"layui-table-page"+g.index,count:a,limit:g.limit,limits:g.limits||[10,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(e,t){if(t||(p.page=e.curr,g.limit=e.limit,p.pullData(e.curr)),p.config.pageLanguage&&!0!==p.config.pageLanguage){var i;if("string"==typeof p.config.pageLanguage){if(!k.config.pageLanguageText[p.config.pageLanguage])return void console.log("找不到"+p.config.pageLanguage+"对应的语言文本定义");i=k.config.pageLanguageText[p.config.pageLanguage]}else{if("object"!==_typeof(p.config.pageLanguage))return;var a=p.config.pageLanguage.lan;if(!a)return;i=b.extend({},k.config.pageLanguageText[a],p.config.pageLanguage.text||{})}if(!i)return;var l=p.layPage.find(">div");l.addClass(B);var n=l.find(".layui-laypage-skip"),o=n.find("input"),r=n.find("button");n.html(i.jumpTo||"jump to"),o.appendTo(n),n.append(i.page||"page"),r.html(i.go||"go").appendTo(n);var c=l.find(".layui-laypage-count"),s=c.text();c.html((i.total||"total")+" "+s.split(" ")[1]+(i.unit?" "+i.unit:""));var d=l.find(".layui-laypage-limits");layui.each(d.find("option"),function(e,t){var a=(t=b(t)).text();t.html(a.split(" ")[0]+" "+(i.optionText||"limit each page"))}),l.removeClass(B)}}},g.page),g.page.count=a,s.render(g.page)),void H.call(p,!0))))};var z=k.Class.prototype.setColsWidth;k.Class.prototype.setColsWidth=function(){var e=this;z.call(e);var t=e.config,a=(t.id,e.elem.find("."+N));if(e.elem[a.length&&e.layHeader.first().find(".layui-table").width()-1>e.layHeader.first().width()?"addClass":"removeClass"]("layui-table-none-overflow"),1<t.cols.length){var i=t.cols.length,l=e.layBox.find(w),n=e.layFixed.find(w+" th"),o=!1;n.each(function(e,t){t=b(t),parseInt(t.attr("rowspan")||"1")<i&&(t.height(l.find('th[data-key="'+t.attr("data-key")+'"]').height()),o=!0)}),o&&e.layFixed.find(">"+w+' th[rowspan="'+i+'"]').height("auto")}},b(window).resize(function(){u.close(h)}),k.Class.prototype.setInit=function(e){var c,s=this,d=s.config,t=d.id;if(d.clientWidth=d.width||function e(t){var a,i;a=(t=t||d.elem.parent()).width();try{i="none"===t.css("display")}catch(e){}return!t[0]||a&&!i?a:e(t.parent())}(),"width"===e)return d.clientWidth;delete k.thisTable.arrs[t],F.check(t)?d.checkStatus&&d.checkStatus.default&&F.set(t,C,d.checkStatus.default):F.init(t,d.checkStatus&&d.checkStatus.default||[]),d.checkDisabled&&R(d.checkDisabled.data)&&d.checkDisabled.data.length&&F.disabled(t,R(d.checkDisabled.data)?d.checkDisabled.data:[]),d.colFilterRecord?c=le.get(t,d.colFilterRecord):le.clear(t);layui.each(d.cols,function(a,i){if(0<a)return!0;layui.each(i,function(e,t){!function a(i,e,l,n){if(n){n.key=i+"-"+l,n.hide=n.hide||!1,n.colspan=n.colspan||1,n.rowspan=n.rowspan||1,s.initOpts(n),n.hide=c&&"normal"===n.type&&n.field&&"boolean"==typeof c[n.field]?c[n.field]:n.hide,1<n.colspan&&delete n.field,n.field||n.toolbar||n.colspan&&1!==n.colspan||-1!==E.indexOf(n.type)?!n[j]||1<n.colspan||(n[j]=!1):n[j]=!0;var o=i+(parseInt(n.rowspan)||1);if(n.colGroup||o<d.cols.length){var r=0;layui.each(d.cols[o],function(e,t){t.HAS_PARENT||1<=r&&r==(n.colspan||1)||(t.HAS_PARENT=!0,t.parentKey=i+"-"+l,r+=parseInt(1<t.colspan?t.colspan:1),a(o,d.cols[o],e,t))}),n.colGroup="boolean"==typeof n.colGroup?n.colGroup:!(n.field||n.toolbar||-1!==E.indexOf(n.type)),n.isGroup=!0}}else e.splice(l,1)}(a,i,e,t)})})};var W=k.Class.prototype.reload;k.Class.prototype.reload=function(e){k.reload(this.config.id,e,!0)},k.Class.prototype.addTemp=function(c,e,t,a){var i=this,s=[],d=[],u=[],f=i.config,y=e||{};c=-c,i.layBody.find('tr[data-index="'+c+'"]').length||(k.cache[i.key][c]=y,i.eachCols(function(e,t){var a=t.field||e,i=f.index+"-"+t.key,l=y[a];if(null==l&&(l=""),!t.colGroup){var n,o,r=['<td data-field="'+a+'" data-key="'+i+'" '+(o=[],"normal"===t.type&&!1!==t.edit&&o.push('data-edit="text"'),t.align&&o.push('align="'+t.align+'"'),t.templet&&o.push('data-content="'+l+'"'),t.event&&o.push('lay-event="'+t.event+'"'),t.style&&o.push('style="'+t.style+'"'),t.minWidth&&o.push('data-minwidth="'+t.minWidth+'"'),o.join(" "))+' class="'+(n=[],t.hide&&n.push(B),t.field||n.push("layui-table-col-special"),n.join(" "))+'">','<div class="layui-table-cell laytable-cell-'+("normal"===t.type?i:i+" laytable-cell-"+t.type)+'">'+function(){var e=b.extend(!0,{LAY_INDEX:c},y);switch(t.type){case"checkbox":case"radio":case"numbers":return""}return t.toolbar?"":T(t,l,e)}(),"</div></td>"].join("");u.push(r),t.fixed&&"right"!==t.fixed&&s.push(r),"right"===t.fixed&&d.push(r)}}),i.layMain.find("."+N).remove(),i.elem.removeClass("layui-table-none-overflow"),i.layMain.find("tbody").append('<tr class="layui-tablePlug-data-temp" data-index="'+c+'">'+u.join("")+"</tr>"),i.layFixLeft.removeClass(B).find("tbody").append('<tr class="layui-tablePlug-data-temp" data-index="'+c+'">'+s.join("")+"</tr>"),i.layFixRight.find("tbody").append('<tr class="layui-tablePlug-data-temp" data-index="'+c+'">'+d.join("")+"</tr>"),i.renderForm(),i.resize(),a||i.layBody.scrollTop(i.layBody[0].scrollHeight),i.layBody.find('tr.layui-tablePlug-data-temp[data-index="'+c+'"]').find("td:first-child").append('<div class="close_temp"></div>'),i.layFixRight.find(".close_temp").remove(),"function"==typeof t&&t.call(i.config,i.layBody.find('tr[data-index="'+c+'"]')))},k.addTemp=function(e,t,a){var i=f(e);"function"==typeof t&&(a=t,t={}),i&&i.addTemp(k.getTemp(e).numbers,t&&"object"===(void 0===t?"undefined":_typeof(t))?t:{},a)},k.getTemp=function(e){for(var t=k.cache[e]||[],a=[],i=1;t[-i];i++)R(t[-i])||a.push(t[-i]);return{data:a,numbers:i}},k.cleanTemp=function(e,t){var a=f(e),i=k.getTemp(e),l=k.cache[e]||[];if(i.data.length)for(var n=i.numbers,o=1;o<n&&(!l[-o]||t&&-o!==t||(l[-o]=[],!t));o++);b('div.layui-table-view[lay-id="'+e+'"]').removeClass("has-data-temp-warn").find("tr.layui-tablePlug-data-temp[data-index"+(t?'="'+t+'"':"")+"]").remove(),k.resize(e),a.layBody.scrollTop(a.layBody[0].scrollHeight)},b(document).on("click",".layui-table-view tr.layui-table-hover.layui-tablePlug-data-temp div.close_temp",function(e){layui.stope(e);var t=b(this).closest("tr"),a=t.closest(".layui-table-view").attr("lay-id");k.cleanTemp(a,t.data("index"))});k.eachCols=function(e,l,n){var o,t=this.thisTable.config[e]||{},r=t.cols&&this.thisTable.arrs[e]||[];n=b.extend(!0,[],n||t.cols),r.length?o=!0:(layui.each(n,function(a,e){if(0<a)return!0;layui.each(e,function(e,t){!function a(i,l,e,n){if(n.isGroup){var o=0;i++,n.CHILD_COLS=[];var r=e+(parseInt(n.rowspan)||1);layui.each(l[r],function(e,t){t.PARENT_COL_INDEX||1<=o&&o==(n.colspan||1)||(t.PARENT_COL_INDEX=i,n.CHILD_COLS.push(t),o+=parseInt(1<t.colspan?t.colspan:1),a(i,l,r,t))})}}(0,n,a,t),t.PARENT_COL_INDEX||r.push(t)})}),this.thisTable.arrs[e]=r);!function i(e){layui.each(e||r,function(e,t){var a=t.key.split("-");if(o&&(t.hide=n[a[0]][a[1]].hide,t[k.config.checkName]=!1,t.width=t.width||0),t[j]||"function"==typeof l&&l(e,t),t.CHILD_COLS)return i(t.CHILD_COLS)})}()};var G=function(){var s=this,e=s.key,d=s.elem;k.eachCols(e,function(e,t){if("normal"===t.type){var c=t.field;if(!c)return;var a=d.find('th[data-field="'+c+'"]');t.filter?a.find(".layui-table-filter").length?a.find(".layui-table-filter").removeClass("layui-active"):b(I.join("")).insertAfter(a.find(".layui-table-cell>span:not(.layui-inline)")).click(function(e){layui.stope(e);var t=d.find(".layui-table-filter.layui-active");t.length&&t[0]!==this&&(t.removeClass("layui-active"),s.layBody.find("tr."+B).removeClass(B));var a=d.find(".layui-table-main"),i=[];layui.each(a.find('td[data-field="'+c+'"]'),function(e,t){var a=(t=b(t)).text();-1===i.indexOf(a)&&i.push(a)});var l=b(this),n=M(l.find(".layui-tablePlug-icon-filter")),o=n.top,r=n.left+l.width();r+200>b(document).width()&&(r-=200+l.width()),h=u.open({content:"",title:null,type:1,area:"200px",shade:.1,closeBtn:0,fixed:!1,resize:!1,shadeClose:!0,offset:[o+"px",r+"px"],isOutAnim:!1,maxmin:!1,success:function(e){e.find(".layui-layer-content").html('<table id="layui-tablePlug-col-filter" lay-filter="layui-tablePlug-col-filter"></table>'),k.render({elem:"#layui-tablePlug-col-filter",data:i.map(function(a,e,t){var i={name:a};return i[k.config.checkName]=!s.layBody.find("tr."+B).filter(function(e,t){return b(t).find('td[data-field="'+c+'"]').text()===a}).length,i}),page:!1,skin:"nob",even:!1,height:8<i.length?300:null,size:"sm",style:"margin: 0;",cols:[[{type:"checkbox",width:40},{field:"name",title:'全选<span class="table-filter-opt-invert" onclick="layui.tablePlug && layui.tablePlug.tableFilterInvert(this);">反选</span>'}]]})},end:function(){l[s.layBody.find("tr."+B).length?"addClass":"removeClass"]("layui-active")}}),k.on("checkbox(layui-tablePlug-col-filter)",function(i){"all"===i.type?s.layBody.find("tr")[i.checked?"removeClass":"addClass"](B):layui.each(s.layBody.first().find('tr td[data-field="'+c+'"]'),function(e,t){if((t=b(t)).text()===i.data.name){var a=t.parent();s.layBody.find('tr[data-index="'+a.data("index")+'"]')[i.checked?"removeClass":"addClass"](B)}})})}):a.find(".layui-table-filter").remove()}},s.config.cols)};k.Class.prototype.reverse=function(){var e=this,t=e.config,a=t.reversal;return e.elem[a?"addClass":"removeClass"]("vertical"),setTimeout(function(){e.layTotal.css({top:a?e.layTool.outerHeight()-1+"px":0}),e.layMain.css({marginLeft:a?e.layHeader.width()+"px":0,marginRight:a&&t.totalRow?e.layTotal.width()+"px":0}),a||e.layHeader.scrollLeft(e.layMain.scrollLeft())},0),e},k.Class.prototype.eachCols=function(e){return k.eachCols(this.config.id,e,this.config.cols),this},k.thisTable.arrs={};var V=k.render;k.render=function(e){var t=V.call(this,e),i=f(t.config.id);return i&&i.layMain,i.layMain&&i.layMain.off("scroll").on("scroll",function(){var e=b(this),t=e.scrollLeft(),a=e.scrollTop();i.layHeader.scrollLeft(t),i.layTotal.scrollLeft(t),i.layFixed.find(A+":not(:hover)").scrollTop(a),u.close(i.tipsIndex)}),i.layFixed&&i.layFixed.find(A).on("scroll",function(){var e=b(this);e.is(":hover")&&(i.layFixed.find(A+":not(:hover)").scrollTop(e.scrollTop()),i.layMain.scrollTop(e.scrollTop()))}),se.timer[t.config.id]&&se.reset(t.config.id),g[t.config.id]=t};var q,X,J,U=k.reload,$=(q=["url","method","where","contentType","headers","parseData","request","response","data","page","initSort","autoSort","reversal"],X=["id","elem","cols","width","height"],{getParams:function(){return b.extend(!0,[],q)},getParamsBlacklist:function(){return b.extend(!0,[],X)},registParams:function(){console.warn("智能重载相关的部分已经从查询模式白名单模式修改为查询模式参数的黑名单模式，所以该方法基本是启用状态，自定义的参数如果不是会修改整个table的框子的可以不用像之前一样要注册一下加入白名单了，使用起来会更加方便一些")},registerBlacklist:function(){console.warn("不建议自己调用改方法将参数加入查询参数的黑名单，除非是在非常了解该功能的前提下");var a=this;layui.each(arguments,function(e,t){R(t)?a.registerBlacklist.apply(a,t):"string"==typeof t&&-1===X.indexOf(t)&&X.push(t)})}}),Q=(J=!0,{enable:function(e){if(!arguments.length)return J;var t=e;"boolean"!=typeof t?n.error("如果要开启或者关闭全局的表格智能重载模式，请传入一个true/false为参数"):J=t}});k.reload=function(e,t,a){t=t||{};var i=Z(e),l=b.extend(!0,{},Z(e),t);if(l.checkStatus||F.reset(e),Q.enable()&&l.smartReloadModel){var n=!1;if(!!l.page!=!!i.page&&(n=!0),!n){var o=$.getParamsBlacklist();layui.each(t,function(e,t){if(-1!==o.indexOf(e))return n=!0})}if(!n){var r=f(e);return"object"===_typeof(t.page)&&(t.page.curr&&(r.page=t.page.curr),delete t.elem,delete t.jump),t.data&&t.data.constructor===Array&&delete r.config.data,a?b.extend(r.config,t):b.extend(!0,r.config,t),r.config.page||(r.page=1),r.loading(),r.pullData(r.page),k.thisTable.call(r)}}if(!a){r=U.call(this,e,t);return g[e]=r}W.call(f(e),t),g[e].config=f(e).config};var Z=function(e){return k.thisTable.config[e]||g[e]&&g[e].config||{}},ee=k.checkStatus;k.checkStatus=function(e,t){var a=ee.call(this,e),i=Z(e);if(i&&i.checkStatus&&(a.status=F.get(e),t)){a.dataCache=[];var l=Y[i.id];layui.each(b.extend(!0,[],F.getChecked(e)),function(e,t){l[t]&&a.dataCache.push(k.clearCacheKey(l[t]))})}if(i&&i.checkDisabled){var n=i.checkDisabled;if("object"===(void 0===n?"undefined":_typeof(n))&&!1!==n.enabled){var o=0,r=0,c=ae(i),s=F.get(e,_);layui.each(k.cache[e],function(e,t){var a=t[c];-1===s.indexOf(a)&&(o++,t[k.config.checkName]&&r++)}),a.isAll=0<r&&o===r}}return a};function te(e,t,a,i){if(F.checkDisabled(e,t))return!1;F.update(e,t,a,i)}var ae=function(e){if(e.primaryKey)return e.primaryKey;var t=e.checkStatus&&e.checkStatus.primaryKey,a=e.checkDisabled&&e.checkDisabled.primaryKey;return t&&a&&t!==a&&layui.hint().error("注意：当前表格("+e.id+")中checkStatus和checkDisabled都配置了primaryKey,但是他们不是同一个字段，必须保持表格配置中主键是唯一的，建议直接设置在顶层配置中就可以了！"),a||t||"id"};k.on("checkbox",function(e){var i=b(this).closest(".layui-table-view"),l=i.attr("lay-id"),t=Z(l);if(F.check(l)){var n=e.checked,a=e.data,o=e.type,r=ae(t);if("one"===o)te(l,a[r],n);else if("all"===o){var c=!1;layui.each(layui.table.cache[l],function(e,t){if(!1===te(l,t[r],n)){c=!0;var a=-1!==F.getChecked(l).indexOf(t[r]);i.find(".layui-table-body").find('tr[data-index="'+e+'"]').find('input[name="layTableCheckbox"]').prop("checked",a),t[k.config.checkName]=a}}),c&&d.render("checkbox",i.attr("lay-filter"))}}}),k.on("radio()",function(e){var t=e.tr.closest(".layui-table-view").attr("lay-id"),a=Z(t);if(F.check(t)){var i=e.checked,l=e.data,n=ae(a);te(t,l[n],i,!0)}}),d.on("checkbox",function(e){b(e.elem).change()});var ie,le=(ie="tablePlug_col_filter_record",{set:function(e,t,a,i){if(e&&t){var l=ne(i),n=this.get(e,i);n[t]=!a,layui[l](ie,{key:e,value:n})}},get:function(e,t){return layui[ne(t)](ie)[e]||{}},clear:function(a){b.each(["data","sessionData"],function(e,t){layui[t](ie,{key:a,remove:!0})})}});function ne(e){return"local"===e?"data":"sessionData"}b(document).on("change",'input[lay-filter="LAY_TABLE_TOOL_COLS"]',function(e){var t=b(this),a=t.attr("name"),i=t.closest(".layui-table-view").attr("lay-id"),l=Z(i).colFilterRecord;l?le.set(i,a,this.checked,l):le.clear(i)}),b(document).off("mousedown",".layui-table-grid-down").on("mousedown",".layui-table-grid-down",function(e){k._tableTdCurr=b(this).closest("td")}),b(document).off("click",".layui-table-tips-main [lay-event]").on("click",".layui-table-tips-main [lay-event]",function(e){var t=b(this);if(k._tableTdCurr){var a=t.closest(".layui-table-tips").attr("times");u.close(a),k._tableTdCurr.find('[lay-event="'+t.attr("lay-event")+'"]').first().click()}}),k.on("toolbar()",function(e){var t=e.config,a=b(this);t.id,t.elem.next();switch(e.event){case"LAYTABLE_COLS":var i=a.find(".layui-table-tool-panel"),l=i.find('[lay-filter="LAY_TABLE_TOOL_COLS"]'),n=i.find('[lay-filter="LAY_TABLE_TOOL_COLS"]:checked');b('<li class="layui-form" lay-filter="LAY_TABLE_TOOL_COLS_FORM"><input type="checkbox" lay-skin="primary" lay-filter="LAY_TABLE_TOOL_COLS_ALL" '+(l.length===n.length?"checked":"")+' title="全选"><span class="LAY_TABLE_TOOL_COLS_Invert_Selection">反选</span></li>').insertBefore(i.find("li").first()).on("click",".LAY_TABLE_TOOL_COLS_Invert_Selection",function(e){layui.stope(e),i.find('[lay-filter="LAY_TABLE_TOOL_COLS"]+').click()}),d.render("checkbox","LAY_TABLE_TOOL_COLS_FORM")}}),d.on("checkbox(LAY_TABLE_TOOL_COLS_ALL)",function(e){b(e.elem).closest("ul").find('[lay-filter="LAY_TABLE_TOOL_COLS"]'+(e.elem.checked?":not(:checked)":":checked")+"+").click()}),b(document).on("change",'input[lay-filter="LAY_TABLE_TOOL_COLS"]',function(e){var t=b(this);b('input[lay-filter="LAY_TABLE_TOOL_COLS_ALL"]').prop("checked",!!t.prop("checked")&&!b('input[lay-filter="LAY_TABLE_TOOL_COLS"]').not(":checked").length),d.render("checkbox","LAY_TABLE_TOOL_COLS_FORM")}),b(document).on("click",'.layui-table-view tbody [lay-event],.layui-table-view tbody tr [name="layTableCheckbox"]+',function(e){layui.stope(e)});function oe(e){e=!!e,b(document).off("mouseenter","."+O+" "+P+" "+A).off("mouseleave","."+O+" "+P+" "+A).off("mouseenter","."+O+" "+D+" "+A).off("mouseleave","."+O+" "+D+" "+A).off("mouseenter","."+O+" "+S+" "+w),e&&b(document).on("mouseenter","."+O+" "+P+" "+A,function(e){var t=b(this).closest(P);"-1px"!==t.css("right")?t.addClass(L):setTimeout(function(){"-1px"!==t.css("right")&&t.addClass(L)},50)}).on("mouseleave","."+O+" "+P+" "+A,function(e){b(this).closest(P).removeClass(L)}).on("mouseenter","."+O+" "+D+" "+A,function(e){var t=b(this).closest(D);t.addClass(L);var a=t.find(w).find("table").width(),i=t.find(w).width()+1;t.css({width:a+"px"}).find(A).css({width:i+"px"})}).on("mouseleave","."+O+" "+D+" "+A,function(e){b(this).css({width:"auto"}).closest(D).css({width:"auto"}).removeClass(L)}).on("mouseenter","."+O+" "+S+" "+w,function(e){b(this).closest(S).removeClass(L)})}oe(!0),d.on("checkbox(layTableAllChoose)",function(e){var t=b(e.elem).closest("."+O);d.render("checkbox",t.attr("lay-filter"),t.find('[lay-filter="layTableAllChoose"]'+(e.elem.checked?":not(:checked)":":checked")).prop("checked",e.elem.checked))}),d.on("checkbox(layTableCheckbox)",function(e){var t=b(e.elem),a=t.closest("."+O),i=a.find('tr[data-index="'+t.closest("tr").data("index")+'"]');d.render("checkbox",a.attr("lay-filter"),i.find('[lay-filter="layTableCheckbox"]'+(e.elem.checked?":not(:checked)":":checked")).prop("checked",e.elem.checked))});function re(e,t){var a=this,i={},l=a.config,n=a.layMain.scrollTop(),o=a.layMain.scrollLeft();return e=0<=e?e:a.layBody.find("tr.layui-table-click").data("index"),i[l.response.statusName]=l.response.statusCode,i[l.response.msgName]="数据更新",i[l.response.dataName]=k.cache[l.id],i[l.response.countName]=a.count||(l.page?l.page.count:k.cache[l.id].length),t&&a.layHeader.find(".layui-table-sort[lay-sort]").attr("lay-sort",""),a.renderData(i,a.page,i[l.response.countName],t),a.layBody.scrollTop(n),a.layMain.scrollLeft(o),"function"==typeof l.done&&l.done(i,a.page,i[l.response.countName]),0<=e&&setTimeout(function(){a.setThisRowChecked(e)},0),a}function ce(e,t,a){if(!t&&0!==t||!a&&0!==a||t<0||a<0||t===a)return this;var i=f(e);if(i){i.config;var l=k.cache[e];if(!l||!l[t]||!l[a])return this;l.splice(a,0,l.splice(t,1)[0]),re.call(i,a,!0)}return this}var se=function a(e,t){var i=this,l=a.timer;if(!1===e)return layui.each(l,function(e,t){a.clear(e)}),i;if(!e)return console.warn("tableId不能为空"),i;var n=f(e);if(!n)return console.warn("找不到id为",e,"的实例"),i;var o=n.config;return!1===t?(a.clear(e),i):t||0===t?((!0===t||t<50)&&(t=50),a.clear(e),void(l[e]={time:t,index:setInterval(function(){b(document).find(o.elem).length?a(e):a.call(i,e,!1)},t)})):(n.pullData(n.page,!0),i)};se.timer={},se.clear=function(e){if(se.timer[e]){clearInterval(se.timer[e].index);var t=se.timer[e].time;return delete se.timer[e],t}},se.reset=function(e){se(e,se.clear(e))};var de=function(o,e,t){var a;if(!o)return console.warn("tableId不能为空"),this;if("string"==typeof o?a=f(o):o=(a=o).key||(a.config?a.config.id:""),!a||!o)return console.warn("找不到id为",o,"的实例"),this;var r=a.config;if(!r.totalRow)return this;var c=a.layTotal;if(e)return c.find('td[data-field="'+e+'"] div.layui-table-cell').html(t||""),this;k.eachCols(o,function(e,t){if(t.totalRow&&!t.totalRowText&&t.field){var a,i=t.field,l=t.totalFormat||"sum",n=b.extend([],k.cache[o]);if("function"==typeof l)a=l.call(r,o,n,i);else switch(a=0,l){case"sum":layui.each(n,function(e,t){a+=parseFloat(t[i])||0})}a&&c.find('td[data-field="'+i+'"] div.layui-table-cell').html(a||"")}})};b.extend(p,{CHECK_TYPE_ADDITIONAL:m,CHECK_TYPE_REMOVED:v,CHECK_TYPE_ORIGINAL:C,tableCheck:F,colFilterRecord:le,getConfig:Z,getIns:function(e){return g[e]},disabledCheck:function(e,t){F.disabled(e,t||[]),o.call(this,e,!0)},dataRenderChecked:y,queryParams:$,smartReload:Q,tableFilterInvert:function(e){var t=(e=b(e)).closest(".layui-table-view"),a=t.attr("lay-id");a&&(k.checkStatus(a).isAll?t.find('[lay-filter="layTableAllChoose"]+').click():t.find('tbody [name="layTableCheckbox"]:checked').length?layui.each(t.find('tbody [name="layTableCheckbox"]'),function(e,t){b(t).next().click()}):t.find('[lay-filter="layTableAllChoose"]+').click())},getPosition:M,reverseTable:function a(e,i){if(e){var t=f(e),l=t.config;"boolean"!=typeof i&&(i=!l.reversal),l.reversal=i,t.reverse(),t.resize()}else layui.each(k.thisTable.that,function(e,t){a(e,i)})},move:ce,moveUp:function(e,t){return ce.call(this,e,t,t-1)},moveDown:function(e,t){return ce.call(this,e,t,t+1)},update:function(e,t,a){if(!e)return console.warn("tableId不能为空"),this;if(t&&("object"===(void 0===t?"undefined":_typeof(t))||R(t))&&(a=t,t=""),null!==t&&!isNaN(t)||(t=""),a&&"object"!==(void 0===a?"undefined":_typeof(a))&&!R(a))return console.warn("data格式必须是对象或者数组"),this;var i=f(e);if(i){var l=k.cache[e],n=i.config;if(!a)return re.call(i),this;R(a)&&(t=""),""!==t?b.extend(!0,l[t],a):(R(a)||(a=[a]),n.primaryKey?layui.each(a,function(e,a){a[n.primaryKey]&&layui.each(l,function(e,t){if(t[n.primaryKey]===a[n.primaryKey])return b.extend(!0,l[e],a),!0})}):b.extend(!0,l,a)),re.call(i)}return this},addData:function(e,t){var a=this;if(!e)return console.warn("tableId不能为空"),a;if(!t)return console.warn("data不能为空"),a;var i=f(e);if(i){var l=i.config;if(l.url)return k.reload(e),a;if(R(l.data)){if("object"!==(void 0===t?"undefined":_typeof(t))&&!R(t))return console.warn("data必须是对象或者数组"),a;R(t)||(t=[t]);var n=ae(l);layui.each(t,function(e,t){n&&(t[n]||(t[n]="idTemp_"+(new Date).getTime()+"_"+Math.round(1e6*Math.random()))),l.data.push(t)}),k.reload(e)}return a}},del:function(i,e){var t=this;if(!i)return console.warn("tableId不能为空"),t;if(!e&&0!==e)return console.warn("data不能为空"),t;var a=f(i);if(a){var l=a.config,n={},o=a.count||(l.page?l.page.count:l.data.length),r=ae(l);if(l.url){if(l.page){R(e)?o-=e.length:o-=1,n.page={};var c=Math.ceil(o/l.page.limit);n.page.curr=0===o?1:a.page>c?c||1:a.page}return layui.each(e,function(e,t){var a="object"===(void 0===t?"undefined":_typeof(t))?t[r]:t;F.update(i,a,!1)}),k.reload(i,n),t}if(R(l.data)){if("object"===(void 0===e?"undefined":_typeof(e))||R(e))R(e)||(e=[e]),layui.each(e,function(e,a){r&&a&&"object"===(void 0===a?"undefined":_typeof(a))&&!a[r]||layui.each(l.data,function(e,t){if(a===t[r]||a[r]===t[r])return l.data.splice(e,1),F.update(i,t[r],!1),o-=1,!0})});else{if(isNaN(e))return t;var s;if(l.page?e<l.page.limit&&(s=l.data.splice((a.page-1)*l.page.limit+e,1)):s=l.data.splice(e,1),!s.length)return t;o-=1,F.update(i,s[0][r],!1)}if(l.page){n.page={};c=Math.ceil(o/l.page.limit);n.page.curr=0===o?1:a.page>c?c||1:a.page}k.reload(i,n)}return t}},refresh:se,renderTotal:de,enableTableFixedScroll:oe}),e(a,p)});